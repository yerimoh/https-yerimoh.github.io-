---
title: "[01] Kotlin:"
date:   2022-12-11
excerpt: "Learn App with Kotlin"
category: [App]
layout: post
tag:
- Kotlin
- App
order: 0

comments: true
---
  
01-2 첫 번째 앱 만들기
앞에서 안드로이드 스튜디오를 설치했으니 이제 안드로이드 스튜디오를 실행하고 첫 번째 앱을 만들어 보겠습니다. 안드로이드 앱을 개발하려면 먼저 프로젝트부터 만들어야 합니다.
그림 1-9 안드로이드 프로젝트 만들기
프로젝트 생성
안드로이드 스튜디오를 실행하면 첫 화면 에서 [New Project]를 선택해 새로운 프로젝트를 만듭니다.
새로운 프로젝트를 만드는 첫 번째 단계는 앱이 실행될 플랫폼과 템플릿을 선택 하는 것입니다. 안드로이드 앱은 스마트 폰뿐만 아니라 웨어러블, TV, 자동차 등 여러 플랫폼에서 실행되지만, 이 책에서는 스마트폰 에서 실행되는 앱을 만듭니다. 따라서 왼쪽 메뉴에서 [Phone and Tablet]을 선택하고 템플릿 목록에서 빈 화면을 기본으로 제공하는 [Empty Activity]를 선택합니다. 빈 화면 말고도 화면이 아예 없는 템플릿부터 내비게이션, 전체 화면, 지도, 탭 화면 등 다양한 템플릿을 제공 합니다
  
  
그다음으로 프로젝트 정보를 입력하는 화면이 나타납니다. 여기서는 Name 부분에 AndroidLab * 이라고 입력하고 나머지는 기본값 그대로 <Finish>를 클릭해 프로젝트를 생성합니다. 그런데 이 부분은 몇 가지 중요한 설정이 있으므로 좀 더 자세히 들여다보겠습 니다.
프로젝트명 패키지명. 프로젝트 식별값 프로젝트 저장 위치 프로젝트 개발 언어
최소 SDK 버전
서포트 라이브러리 사용 여부
그림 1-11 프로젝트 설정
Package name은 앱의 식별값입니다. 안드로이드 앱은 개발자가 작성한 패키지명으로 식별 됩니다. 패키지명이 같은 앱은 스토어에 등록할 수 없을 뿐 아니라 기기에 설치할 수도 없으 므로 고유한 이름으로 지어야 합니다. 보통은 도메인을 역순으로 입력하고 끝에 프로젝트명을 붙이는 형태로 작성합니다. 필자는 com.example.androidlab으로 입력했습니다.
Save location은 프로젝트의 파일들이 저장되는 루트 디렉터리입니다. 앱을 개발하면서 추가하는 소스나 이미지 등이 이 디렉터리에 저장됩니다. 그런데 C:\에는 쓰기 권한이 없을 수있으므로 오른쪽에 디렉터리 모양 아이콘( )을 눌러 C:\ 아래 디렉터리를 하나 만들고 그곳을 지정해야 합니다.
Language는 안드로이드 앱을 어떤 언어로 개발할 것인지를 나타냅니다. 안드로이드 스튜디 오는 개발 언어로 Kotlin과 Java 2가지를 지원하는데 기본값은 Kotlin입니다. 만약 Java로 개발하고 싶다면 Java를 선택하면 됩니다. 다만 여기서 Kotlin으로 지정했어도 Java 파일을 언제든지 추가할 수 있습니다. 즉, 여기서 지정한 언어로 프로젝트의 기본 소스 파일과 설정이 추가되는 것이지 꼭 그 언어로만 개발해야 하는 것은 아닙니다
Minimum SDK는 앱이 설치되는 최소 SDK 버전입니다. 이 프로젝트로 개발한 앱은 여기서 설정한 버전 이상의 폰에만 설치됩니다. 이 부분은 「02-3」절에서 빌드 설정 파일을 살펴볼때 좀 더 다루겠습니다. 참고로 여기서 SDK 버전을 선택하면 이 앱을 실행할 수 있는 기기의 점유율이 아래쪽에 나타납니다.
그 아래 Use legacy android.support libraries라고 적힌 체크박스는 android.support 라이 브러리를 사용할 것인지를 선택하는 옵션입니다. 구글은 안드로이드 앱 개발을 지원하고자 다양한 라이브러리를 제공하는데 이 라이브러리를 통칭해서 서포트 라이브러리라고 합니다.
그런데 서포트 라이브러리를 제트팩 JetPack 의 androidx 라이브러리로 통합했습니다. 제트팩과 androidx 라이브러리는 11장에서 자세하게 다룹니다. 새로 만드는 앱이라면 굳이 support 라이브러리를 이용할 필요는 없으므로 여기서는 체크박스를 해제합니다.
안드로이드 스튜디오의 화면 구성
프로젝트를 만들면 앱을 빌드하는 데 필요한 각종 준비 작업이 자동으로 진행됩니다. 이 작업이 끝나면 * 다음과 같은 화면이 보입니

1 툴바: 앱을 실행하거나 안드로이드 도구를 시작하는 다양한 작업 아이콘이 있습니다.
2 탐색 메뉴: 프로젝트를 탐색하고 수정할 파일을 열 수 있습니다.
3 편집기 창: 코드를 작성하고 수정할 수 있습니다.
4 도구 창 모음: 창 양옆과 아래쪽에 개별 도구 창을 열거나 닫을 수 있는 버튼이 있습니다.
5 프로젝트 창: 프로젝트 파일을 관리할 수 있습니다.
6 상태 표시줄: 프로젝트와 안드로이드 스튜디오의 상태나 경고 메시지 등을 보여 줍니다.
안드로이드 스튜디오 아래쪽에는 각종 도구 창을 열 수 있는 탭이 있는데, 그중 로그캣 Logcat 에는 앱이 실행 중일 때 발생하는 로그가 출력됩니다. 앱에서 출력한 로그나 오류 메시지 등을 확인할 때 자주 보는 창이므로 기억해 두기 바랍니다.
그림 1-13 로그캣
SDK 매니저
안드로이드 스튜디오 화면의 오른쪽 위를 보면 툴바에 아이콘이 보입니다. 이 아이콘을 클릭하면 안드로이드 SDK를 관리할 수 있는 SDK 매니저가 열립니다.

  첫 번째 탭인 [SDK Platforms]에서는 안드로이드 SDK 목록을 보여 줍니다. 안드로이드 스튜디오를 설치할 때 최신 버전의 SDK * 가 기본으로 설치되므로 목록에서 해당 버전에 체크 표시된 것을 확인할 수 있습니다. 이 목록에서 체크박스에 표시하거나 해제하는 방법으로 SDK를 설치하거나 업데이트 또는 제거할 수 있습니다.
체크박스를 변경하면 <Apply>가 활성화되므로 이 버튼을 클릭해서 수행합니다.
깡샘!
질문 있어요!
최신 버전이 아닌 SDK를 설치할 필요가 있나요?
보통은 최신 버전의 SDK로 개발하지만 더 낮은 버전에서 테스트할 수도 있습니다. 따라서 다른 버전의 SDK를 설치할 때도 많습니다. 예를 들어 지금 최신 버전은 안드로이드 12지만 호환성을 테스트하고자 의도적으로 11 버전을 설치할 수도 있습니다.
두 번째 탭인 [SDK Tools]를 클릭하면 개발자 도구들이 표시됩니다.
AMD CPU라면 설치
인텔 CPU라면 설치
그림 1-15 SDK 개발자 도구
기본으로 필요한 도구는 안드로이드 스튜디오를 설치할 때 포함되므로 추가로 설치할 필요는 없습니다. 그러나 각 도구를 최신 버전으로 업데이트하거나 에뮬레이터 추가 도구를 이곳 에서 설치할 수 있습니다. 혹시 필수 도구가 설치되지 않았다면 다음 표를 참고하여 설치하고될 수 있으면 최신 버전으로 유지하는 것이 좋습니다.

표 1-1 SDK 도구
이름 용도 설치 여부
Android SDK Build-Tools 32-rc1 앱을 빌드하는 데 필요한 도구
Android Emulator 앱을 실행하는 데 필요한 도구
필수 설치
안드로이드 플랫폼과 연동되는 adb, fastboot, systrace와 같은 도구 모음
Android Emulator Hypervisor Driver for AMD Processors(Installer)
AMD CPU라면 설치
Intel x86 Emulator Accelerator (HAXM intaller)
인텔 에뮬레이터 가속기 인텔 CPU라면 설치
표에서 위 3가지는 꼭 설치해야 하며 아래 2가지는 자신의 CPU에 따라 설치하면 됩니다. 그런데 AMD의 하이퍼바이저 드라이버나 인텔의 가속기인 HAXM을 설치하려면 먼저 CPU가 가상화 기술을 지원해야 하며 이를 활성화(BIOS 설정)해야 합니다.
이러한 내용은 컴퓨터 환경에 따라 달라지므로 안드로이드 개발자 사이트에서 관련 문서 * 를 확인하기 바랍니다.
* 에뮬레이터 VM 가속 구성: developer.an droid.com/studio/run/emulator-accelera tion?hl=ko#accel-vm
그림 1-16 윈도우10에서 가상화 사용 확인(검색란에 ‘작업 관리자’로 실행)
기타 설정
여기서는 안드로이드 스튜디오의 몇 가지 설정을 살펴보겠습니 다. 이 설정은 필수는 아니지만 앱 개발을 좀 더 편리하게 합니다.
특히 자동 임포트 설정은 이 책의 실습을 진행하는 데 필요한 옵션 입니다. 안드로이드 스튜디오를 설정하려면 메뉴에서 [File → Settings]를 선택합니다.

01-3 앱 실행하기
이제 앱을 실행해 테스트하는 방법을 살펴보겠습니다. 2가지 방법이 있는데 하나는 안드로이드 스튜디오가 제공하는 가상 기기를 이용하는 방법이고, 또 하나는 실제 스마트폰을 이용하는 방법입니다. 차례대로 살펴보겠습니다.
가상 기기에서 실행
안드로이드 가상 기기는 AVD Android virtual device 라고 하며 흔히 에뮬레이터 Emulator 라고 부릅니다.
먼저 AVD로 앱을 테스트하는 방법을 살펴보겠습니다. 안드로이드 스튜디오에서 오른쪽 위에 있는 아이콘을 클릭하면 AVD 매니저가 실행됩니다. AVD 매니저에서 [Create Virtual Device]를 클릭하면 에뮬레이터 만들기를 시작합니다.
그림 1-21 AVD 매니저 아이콘과 생성 창
하드웨어 선택
다음처럼 하드웨어를 선택하는 창이 나타나면 목록에서 선택하고 <Next>를 클릭합니다. 이책에서는 기본으로 선택된 Pixel 2 스마트폰으로 진행하겠습니다.

시스템 이미지 선택
그다음으로 시스템 이미지를 선택하는 창이 나타납니다. AVD 설정에서 이 부분이 가장 중요 한데 앞에서 선택한 하드웨어에 설치할 시스템 이미지, 즉 안드로이드 운영체제 버전을 선택 해야 합니다. 우선 목록 위에서 두 번째 탭인 [x86 Images]를 클릭합니
  
  이 책에서 개발하는 앱은 S 버전으로 실습합니다. 따라서 여기서는 다음과 같은 버전의 시스템 이미지를 선택하고 <Next>를 클릭합니다. 만약 해당 버전이 설치돼 있지 않다면 이름 옆에 <Download>가 표시되므로 이를 클릭해서 설치한 후에 진행합니다.
•이름: S •API 레벨: 31
•ABI: x86_64
•Target: Android 12.0(Google APIs)
참고로 Play 스토어 같은 구글의 기본 앱이 설치된 버전은 [Recommended] 탭에 표시되고, [x86 images] 탭에는 나머지 버전까지 모두 표시됩니다. 그런데 [Recommended]와 [x86
images]에 있는 AVD는 앞에서 소개한 인텔의 하드웨어 가속 기능인 HAXM hardware accelerated
execution manager 을 사용합니다. HAXM을 이용하면 AVD가 더 빠르게 동작합니다. 대부분은 안드로이드 스튜디오를 설치할 때 HAXM도 함께 설치됩니다. 만약 HAXM을 설치할 수 없는 환경이라면 [Other images]에 있는 시스템 이미지를 사용해야 합니다.
설정 확인 및 완료
시스템 이미지를 선택하고 <Next>를 클릭하면 다음처럼 설정을 확인하는 마지막 창이 나옵 니다. 여기서 AVD 이름을 비롯해 여러 가지 설정을 변경할 수 있습니다. 기본값으로 <Finish>를 클릭해 AVD 만들기를 완료합니다.

에뮬레이터 실행
이렇게 AVD를 만들면 매니저 창에 추가됩니다. 여기서 Actions 항목에 있는 버튼을 누르면 에뮬레이터 실행, AVD 수정, 기타 메뉴를 실행할 수 있습니다. 버튼을 클릭해 에뮬레이터를 실행해 보세요.
그림 1-25 AVD 매니저 창에 추가된 AVD
그러면 오른쪽 그림처럼 에뮬레이터가 실행됩니다. 오른쪽 명령 도구에는 전원, 볼륨, 회전 등 조작 버튼이 있고, 더 보기 버튼( ) 을 클릭하면 위치나 화면, 네트워크, 배터리 등 여러 가지 설정을할 수 있는 창이 열립니다.
그림 1-26 AVD 구동
에뮬레이터에서 앱 실행
AVD까지 준비했으므로 이제 앱을 실행해 보겠습니다. 먼저 안드로이드 스튜디오 툴바에서 실행할 앱을 선택합니다. 지금은 프로젝트에 app이라는 앱만 있으므로 이를 선택합니다. 그리고 그 오른쪽에서 앱을 실행할 기기를 선택합니다. 여기에는 현재 실행 중인 AVD나 연결된 스마트폰 이름이 표시됩니다. 앞에서 만든 AVD 이름이 표시된 것을 확인하고 오른쪽에 있는 버튼을 클릭하면 앱을 빌드

한 후 실행합니다. 즉, app이라는 이름의 앱을 Pixel 2 API 31 기기에 설치한 후 실행합니다.
소스 코드에 오류가 없다면 잠시 후 빌드가 끝나고 에뮬레이터가 뜨면서 앱이 실행됩니다. 이 과정은 컴퓨터 사양과 가속 기능 사용 여부에 따라서 시간이 걸릴 수 있습니다.
그림 1-28 에뮬레이터에서앱 실행 결과
실제 스마트폰에서 실행
앱을 개발할 때는 대부분 에뮬레이터에서 테스트할 수 있지만 최종 배포하기 전에는 실제 기기에서 테스트해 봐야 합니다. 또한 에뮬레이터를 실행하기 어려운 환경이거나 성능이 까다로운 앱은 실제 기기에서 테스트하기도 합니다.
윈도우용 USB 드라이버 설치
앱을 실제 스마트폰에서 실행하려면 먼저 컴퓨터와 연결해야 합니다. 그런데 macOS에서는 컴퓨터가 스마트폰을 자동으로 인식하지만, 윈도우에서는 USB 드라이버를 설치해 줘야 합니다. 윈도우용 USB 드라이버는 스마트폰 제조사 홈페이지 * 에서 내려받을 수 있습니다.

여기서는 삼성전자의 스마트폰을 예로 들어 설명하겠습니다. USB 드라이버를 내려받아 실행한 뒤 안내하는 대로 <다음>을 클릭해 설치합니다.
그림 1-30 드라이버 설치
스마트폰에 USB 디버깅 허용
드라이버를 설치했으면 이제 스마트폰에서 USB 디버깅을 허용해 줘야 합니다. 그런데 스마 트폰마다 설정 메뉴가 약간 다를 수 있습니다. 이 책에서는 갤럭시 스마트폰을 기준으로 설명 하겠습니다.
스마트폰에서 설정 앱을 실행하고 아래쪽으로 스크롤하여 [휴대전화 정보 → 소프트웨어 정보]를 선택합니다. 소프트웨어 정보에서 [빌드 번호]가 보이면 손가락으로 7번 터치하세요.
그러면 토스트 메시지로 “개발자 모드를 켰습니다.”라는 메시지가 나옵니다.

메시지가 정상으로 표시되었다면 뒤로가기 버튼을 2번 눌러 처음 화면으로 돌아옵니다. 이제 [휴대전화 정보] 아래 [개발자 옵션]이 생긴 것을 확인할 수 있습니다. 이 메뉴를 선택하고 [USB 디버깅] 항목을 찾아서 체크합니다. 그러면 허용 여부를 묻는 창이 나타나는데 여기서 <확인>을 선택하면 스마트폰의 개발자 모드가 설정됩니다.
그림 1-32 개발자 옵션에서 USB 디버깅 허용하기
이제 컴퓨터와 스마트폰을 USB로 연결하면 스마트폰에 “USB 디버깅을 허용하시겠습니까?”라는 창이 나타납니다. 여기서 <허용> 을 선택합니다. 이때 <이 컴퓨터에서 항상 허용>에 체크하면 다음에 다시 연결할 때 자동으로 허용합니다.
그림 1-33 USB 디버깅 허용
스마트폰에서 앱 실행
이렇게 스마트폰을 컴퓨터에 연결하면 안드로이드 스튜디오에서 실행 대상 기기 부분에 연결한 스마트폰 이름이 표시됩니다. 여기서 버튼을 클릭하면 해당 스마트폰에 앱이 설치되어 실행됩니다.
설치 문제 해결 팁
축하합니다. 이제부터 여러분도 안드로이드 앱을 개발할 수 있습니다. 그런데 각종 프로그램을 설치하고 설정하는 과정에서 자신의 컴퓨터 환경에 따라 막히는 부분이 생길 수도 있습니

다. 안타깝게도 이러한 설치 문제는 원인이 워낙 다양해서 다 소개할 수는 없습니다. 다만 많은 사람이 자주 겪는 문제는 다음 공식 문서에서 확인할 수 있습니다.
• 안드로이드 스튜디오 문제 해결: developer.android.com/studio/troubleshoot?hl=ko • 에뮬레이터 문제 해결: developer.android.com/studio/run/emulator-troubleshooting?hl=ko
또한 문제가 발생한 오류 메시지를 키워드로 검색 사이트에서 해결 사례를 찾거나 프로그램을 완전히 삭제한 후 다시 설치해 보는 것도 좋01-4 앱 출시하기
* 앱 출시는 모든 개발을 마치고 최종 단계에서 해야 하므로 지금은 제목 위주로 빠르게 훑어보고 필요할 때 자세하게 살펴봐도 좋습니다.
이번 절에서는 앱을 완성한 후에 사용자에게 제공하는 과정을 살펴보겠습니다 * . 앱을 출시하 려면 프로젝트의 여러 파일을 하나로 묶어서 배포해야 합니다. 그리고 이 배포 파일을 여러 사람이 내려받을 수 있도록 스토어에 등록해야 합니다.
두 과정은 잠시 후에 실습으로 진행하기로 하고, 앱을 출시하기 전에 알아야 할 사항을 먼저 살펴보겠습니다.
배포 파일
사용자가 자신의 안드로이드 스마트폰에 앱을 설치하려면 구글의 Play 스토어나 기타 앱 마켓에서 내려받아야 합니다. 이때 사용자는 개발자가 등록한 배포 파일을 내려받습니다. 안드 로이드 앱의 배포 파일은 APK와 AAB가 있습니다. APK Android application package 는 안드로이드의 전통적인 배포 파일로서 컴파일된 코드와 리소스를 묶어서 키로 서명한 것입니다. 그리고 AAB Android app bundle * 는 2018년 구글 IO에서 발표한 새로운 안드로이드 앱배포 파일입니다.
AAB 파일은 Play 스토어에 올리면 사용자 기기에 맞게 최적화된 APK를 대신 만들어 줍니 다. 즉, 사용자 기기에 내려받아 앱을 설치하는 파일은 똑같이 APK지만, 개발자가 직접 APK 파일을 만들지 않고 Play 스토어에서 최적화된 파일을 만들어 주는 것이죠. 이때 앱을 내려받는 기기에 맞는 파일만 포함하므로 앱의 크기가 줄어드는 효과가 있습니다. 결국 AAB 방식으로 등록된 앱을 내려받는 사용자는 APK 방식과 달리 사용자 기기에 필요한 파일만 내려받게 됩니다

  
  안드로이드 스튜디오에서는 APK나 AAB로 앱을 빌드할 수 있으며 구글 Play 스토어에도 둘중 하나를 등록할 수 있습니다. 그런데 구글에서는 2021년 8월부터 Play 스토어에 새로운 앱을 게시할 때 AAB를 사용해야 한다고 발표했으므로 이 책에서는 AAB 배포를 다룹니다.
깡샘!
질문 있어요!
개발자가 앱을 만들 때 포함한 파일이 사용자가 내려받는 앱에 모두 담기지 않아도 괜찮 나요?
앱을 실행할 때 앱에 포함한 모든 파일이 사용되지는 않습니다. 예를 들어 앱을 개발할 때 크기가 다른 여러 기기에서 실행할 수 있도록 이미지 리소스를 크기별로 준비하지만, 앱을 내려 받은 기기에서는 그 크기에 맞는 1가지 이미지만 이용합니다. 나머지 이미지는 사용하지 않으면서 앱에 포함되는 것이죠. 또 다국어를 지원하는 앱에서도 리소스를 언어별로 여러 개 준비하지만 한국어로 지정된 기기에서 이 앱을 내려받으면 나머지 언어 리소스는 쓸모없게 됩니다.
앱 서명
안드로이드 배포 파일을 만들려면 키를 만들어 앱에 서명해야 합니다. 앱을 서명하는 방법은 크게 2가지로 나뉘는데 하나는 서명 키를 개발자가 직접 만들어 관리하는 방법이고, 하나는 구글 Play에서 관리하는 방법입니다.
앱 서명 키로 서명 앱 서명 키로 앱 서명 개발자
구글
사용자
앱 서명 키
그림 1-36 개발자가 서명 키를 관리
개발자가 서명 키를 직접 관리하는 방법은 출시용으로 앱을 빌드할 때 개발자가 만든 키로 앱을 서명하고 이를 Play 스토어에 등록하여 사용자에게 전달합니다. 즉, 개발자가 만든 서명키 1개로 앱을 관리합니다. 그런데 이렇게 하면 만에 하나 개발자가 키를 분실하거나 도용될때 대처할 수가 없습니다. 즉, 앱을 업데이트하려면 이전 버전과 똑같은 키로 서명해야 하는데 서명할 수가 없어서 업데이트를 하지 못합니다. 만약 새로운 키를 만들어 서명하면 완전히 새로운 앱으로 등록됩니다.
이러한 문제점을 해결하고자 구글에서는 Play 앱 서명이라는 서비스를 만들었습니다.

  
  구글 Play 앱 서명 방식은 키를 2개로 구분합니다. 개발자가 만들고 관리하는 업로드 키(기존 서명 키)와 구글 Play가 만드는 앱 서명 키입니다. 개발자가 키를 만들어 앱을 서명하지만 이키는 앱을 구글 Play에 등록할 때만 사용하는 업로드 키입니다. 구글 Play는 업로드된 앱을 다시 자체적으로 만든 키로 서명해서 사용자에게 전달합니다. 구글 Play의 앱 서명 키는 구글 에서 관리하며 개발자가 직접 제어할 수 없습니다.
이처럼 키가 구분돼 있어서 만약 개발자가 키를 분실하거나 도용되더라도 앱을 서명한 키는 안전하므로 앱을 계속 업데이트할 수 있습니다. 개발자가 관리하는 업로드 키는 다시 만들어 Play 스토어에 등록하면 됩니다.
구글 Play 스토어에 게시
앱을 사용자에게 배포하는 방법은 다양합니다. 구글 Play 스토어를 이용할 수도 있고, 이동통 신사에서 운영하는 마켓을 이용할 수도 있습니다. 또한 APK 파일을 사용자에게 직접 전달할 수도 있습니다. 하지만 대부분은 구글 Play 스토어에 배포하므로 이 책에서는 구글 Play 스토 어에 앱을 배포하는 방법을 살펴보겠습니다.
Play 스토어에 앱을 배포하기 전에 미리 준비해야 할 파일은 다음과 같습니다.
• AAB 파일: 완성한 앱을 서명한 배포 파일입니다.
• 앱 아이콘 이미지: Play 스토어에 표시할 앱 이미지입니다. 512×512px 크기에 1MB 미만으로 JPEG나 32비트 PNG 파일을 준비해야 합니다.
• 그래픽 이미지: Play 스토어에서 앱을 프로모션할 때 이용할 이미지입니다. 1,024×500px 크기에 1MB 미만으로 JPEG나 24비트 PNG 파일을 준비해야 합니다.
• 휴대전화 스크린샷: 스마트폰에서 앱을 실행한 스크린샷입니다. 320~3,840px 크기(비율은 16:9나 9:16)에 1개당 8MB 미만 이미지를 2~8개 JPEG이나 24비트 PNG 파일로 준비해야 합니다.
• 7인치·10인치 태블릿 스크린샷: 7인치나 10인치 태블릿에서 앱을 실행한 스크린샷입니다.
320~3,840px 크기(비율은 16:9나 9:16)에 1장당 8MB 미만 이미지를 최대 8개 JPEG나 24비트 PNG 파일로 준비해야 합니다.
  
  지금부터는 AAB 배포 파일을 만들고 구글 플레이에 게시하는 과정을 단계별 실습으로 살펴 보겠습니다. Play 스토어에 앱을 게시하려면 구글의 정책을 따라야 하는데 Play 스토어 운영 정책은 수시로 바뀝니다. 따라서 실제로 앱을 게시할 때는 책의 내용과 조금 다를 수 있으므로 구글 Play 콘솔에서 안내하는 사항을 꼼꼼하게 읽고 진행해야 합니다.
AAB 배포 파일 만들기 Do it! 실습
그림 1-38 모듈 수준의 빌드 그래들 파일
1단계 고유한 패키지명으로 바꾸기
안드로이드 앱은 개발자가 지정한 고유한 패키지명으로 식별됩니다. 그런데 안드로이드 스튜디오에서 프로 젝트를 만들 때 기본인 com.example로 시작하는 패키지명은 Play 스토어에 등록할 수 없습니다. 따라서 출시용 앱으로 빌드하기 전에 고유한 패키지명으로 바꿔야 합니다.
패키지명을 바꾸려면 모듈 수준의 build.gradle 파일을 수정해야 합니다. 안드로이드 스튜디오의 프로젝트 창을 보면 [Gradle Scripts] 범주 아래 build.gradle (Module: AndroidLab.app)이라는 파일이 있습 니다. 여기서 AndroidLab과 app은 개발자가 지정한 프로젝트명과 모듈명입니다. 이 파일을 열어 applicationId 항목을 고유한 이름으로 수정하면 됩니다.
Do it! • build.gradle (Module: AndroidLab.app)
android { defaultConfig { applicationId "com.xxx.xxx" (... 생략 ...)
}
(... 생략 ...)
}
빌드 그래들 파일을 수정하면 편집 창 위쪽에 동기화 메뉴가 나타납니다. 여기서 <Sync now>를 클릭해 빌드 구성을 동기화해야지만 수정한 내용이 적용됩니다. 앞으로 그래들 파일을 수정할 때마다 이 내용을 꼭 기억하기 바랍니다.

  
  2단계 AAB 파일 생성 시작하기
이제 AAB 배포 파일을 만들어 보겠습니다. 완성한 프로젝트가 안드로이드 스튜디오에 열린 상태에서 [Build → Generate Signed Bundle / APK] 메뉴를 선택합니다. 오른쪽 그림처럼 배포 파일 형식을 선택하는 창이 나오면 [Android App Bundle]을 선택한 후 <Next>를 클릭합니다.
그림 1-40 Android App Bundle 선택
3단계 키 저장소와 서명 키(업로드 키) 만들기
이제 키 저장소가 필요합니다. 키 저장소 key store 는 일종의 인증서라고 생각하면 됩니다. 키 저장소로 내가 만든 앱에 서명해야지만 앱을 출시할 수 있습 니다. 오른쪽 화면에서 만약 이전에 만들어 놓은키 저장소가 있다면 <Choose existing>을 클릭 하여 선택하고, 새로 만들어야 한다면 <Create new>를 클릭합니다.
키 저장소 생성 창이 열리면 경로 부분에 디렉터리 아이콘( )을 눌러 저장할 위치를 선택하고 이름을 입력한 후 <OK>를 클릭합니다. 이어서 키 저장소 경로 아래 비밀번호를 입력합니다. 그리고 키 영역에서 별칭 alias 과 비밀번호, 기타 키 정보를 적절하게 입력한 후 <OK>를 클릭하면 확장자가 .jks인 키 저장소 파일이 만들어집니다.

  
  그런데 필자가 확인해 보니(2021년 7월 19일 확인) 키 저장소 비밀번호( 5 )와 키 비밀번호( 6 )를 똑같이 지정해야만 키가 정상으로 만들어집니다. 이는 일시적인 문제일 수도 있습니다. 만약 키 저장소와 키비밀번호를 다르게 지정했을 때 키가 만들어지지 않으면 터미널에서 키를 생성하면 됩니다. 안드로이드 스튜디오에서 터미널 창을 열고 키를 저장할 위치로 이동한 후 다음과 같은 명령을 입력합니다.
> keytool -genkey -v -keystore test -storepass aaaaaa -alias my_key -keypass bbbbbb -keyalg RSA -keysize 2048 -validity 10000
키를 만드는 명령은 keytool이며 다음과 같은 속성값을 알맞게 입력합니다.
• test: 키 저장소 이름을 입력합니다.
• aaaaaa: 키 저장소 비밀번호를 입력합니다.
• my_key: 키 이름을 입력합니다.
• bbbbbb: 키 비밀번호를 입력합니다.
▶ 실행 결과
몇 가지 질문에 답한 후(그 Sh 냥 ift Alt Del
를 눌러 생략해도 됩니다) 마지막에 “예”를 입력하면 키가 만들어집 니다. 이렇게 만든 키를 그림 1-41과 같은 창에서 <Choose existing>을 눌러 선택한 후 다음 단계를 진행합니다.
Enter Spacebar Caps Lock Num Lock Tab Esc fn Ctrl
, . ‘ ’
1
2 3 4
5 +
F1 F2 F3 F4 F5 F6 F7 F8 F9 F10 F11 F12
4단계 앱 서명하기
A B C D E F G H I J K L M N O P Q R S T U V W X Y Z
다시 돌아온 앱 서명 창에서 방금 생성한 키 저장소 비빌번호와 키 별칭, 비밀번호를 정확하게 입력합니 다. 그리고 [Export encrypted key … (암호화된 키 내보내기)] 체크박스를 해제하고 <Next>를 클릭

  만약 이미 Play 스토어에 등록된 앱을 Play 앱서명으로 다시 등록하려면 [Export encrypted key …] 체크박스를 체크하고 경로를 지정합니 다. 그러면 서명 키로 암호화된 *.pepk 파일로 저장됩니다. 이 파일로 기존 앱을 Play 앱 서명 으로 등록할 수 있습니다.
5단계 릴리즈용 빌드하기
마지막으로 AAB 파일을 디버그 debug 용으로 만들 것인지 릴리즈 release 용으로 만들 것인지를 선택합니다. [release]를 선택하고 <Finish>를 클릭하면 서명된 AAB 파일로 빌드를 시작합니다.
그림 1-43 앱 서명하기
그림 1-44 빌드 구성 선택
6단계 빌드된 AAB 파일 확인하기
잠시 후 안드로이드 스튜디오가 빌드를 마치면 프로젝트 루트 디렉터리에 app\release\apprelease.aab 파일이 만들어집니다. 파일명에서 app은 프로젝트의 모듈명에 해당합니다. 이 파일을 Play 스토어에 등록하여 앱을 출시하는 방법은 다음 실습에서 살펴보겠습니다.

