---
title: "[02] Machine Learning: sklearn을 사용한 MNIST 분류  "
date:   2020-03-10
excerpt: "머신러닝의 여러가지 기초 개념과 용어, 지도학습, 비지도 학습의 차이"
category: [Machine Learning]
layout: post
tag:
- Machine Learning
order: 0

comments: true
---

# 

----
---

👀, 🤷‍♀️ , 📜    
이 아이콘들을 누르시면 코드, 개념 부가 설명을 보실 수 있습니다:)

---
----

# INTRO

고등학생과 미국 인구조사국 직원들이 손으로 쓴 70,000 개의 작은 숫자 이미지를 모은 MNIST 데이터셋을 사용할 것이다.      
각 이미지에는 어떤 숫자를 나타내는지 레이블링이 되어 있다.         

이 데이터셋은 학습용으로 아주 많이 시용되기 때문에 머신러닝 분야의 ‘Hello World’ 라고 불린다.       

![image](https://user-images.githubusercontent.com/76824611/138802301-5dc673f8-22d0-4d16-8f3e-d80fd20b769a.png)

먼저, 필요한 모듈들을 모두 불러오겠다
<details>
<summary>👀코드 보기</summary>
<div markdown="1">
  
```python
# 파이썬 ≥3.5 필수
import sys
assert sys.version_info >= (3, 5)

# 사이킷런 ≥0.20 필수
import sklearn
assert sklearn.__version__ >= "0.20"

# 공통 모듈 임포트
import numpy as np
import os

# 노트북 실행 결과를 동일하게 유지하기 위해
np.random.seed(42)

# 깔끔한 그래프 출력을 위해
%matplotlib inline
import matplotlib as mpl
import matplotlib.pyplot as plt
mpl.rc('axes', labelsize=14)
mpl.rc('xtick', labelsize=12)
mpl.rc('ytick', labelsize=12)

# 그림을 저장할 위치
PROJECT_ROOT_DIR = "."
CHAPTER_ID = "classification"
IMAGES_PATH = os.path.join(PROJECT_ROOT_DIR, "images", CHAPTER_ID)
os.makedirs(IMAGES_PATH, exist_ok=True)

def save_fig(fig_id, tight_layout=True, fig_extension="png", resolution=300):
    path = os.path.join(IMAGES_PATH, fig_id + "." + fig_extension)
    print("그림 저장:", fig_id)
    if tight_layout:
        plt.tight_layout()
    plt.savefig(path, format=fig_extension, dpi=resolution)
```
  
</div>
</details>


----


# 데이터 셋 불러오기   

그럼 먼저 데이터 셋을 불러와보자.      




  
```python
from sklearn.datasets import fetch_openml
mnist = fetch_openml('mnist_784', version=1, as_frame=False)
mnist.keys()
```
  
이 데이터 셋을 살펴보기 위해 ```mnist.keys()```를 사용하면,       
* **DESCR**: 데이터셋을 설명      
* **data**: 샘플이 하나의 행, 특성이 하나의 열로 구성된 배열    
* **target**: 레이블 배열(정답)     
```python
dict_keys(['data', 'target', 'frame', 'categories', 'feature_names', 'target_names', 'DESCR', 'details', 'url'])
```  

<details>
<summary>📜 위 배열들 자세히 보기</summary>
<div markdown="1">
 
이미지가 70,000 개 존재    
* 각 이미지에는 784 개의 특성 존재   
  * 이미지가 28 X 28 픽셀이기 때문.       
  * 개개의 특성은 단순히 흰색 부터 255( 검은색)까지의 픽셀 강도를 나타냄     
![image](https://user-images.githubusercontent.com/76824611/138952849-416f3172-79ac-4ff9-aa99-83550c07106a.png)

```python
X, y = mnist["data"], mnist["target"]
X.shape
#(70000, 784)
y.shape
#(70000,)
```
  
</div>
</details>
  
<details>
<summary>📜 targe 자세히 보기</summary>
<div markdown="1">
 

```python
y = mnist["target"]
```
  
이때, y[0]은 아래와 같다
![image](https://user-images.githubusercontent.com/76824611/138953180-e9ee0a77-6e85-4477-aeae-bdbabe1beb98.png)
  
그러므로 이 이미지의 정답 레이블은 5여야 한다.  
  
```python
y[0]
# '5'
```
  
</div>
</details>  
