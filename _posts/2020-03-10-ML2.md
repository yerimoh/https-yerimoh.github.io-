---
title: "[02] Machine Learning: sklearn을 사용한 MNIST 분류  "
date:   2020-03-10
excerpt: "머신러닝의 여러가지 기초 개념과 용어, 지도학습, 비지도 학습의 차이"
category: [Machine Learning]
layout: post
tag:
- Machine Learning
order: 0

comments: true
---

# 

----
---

👀, 🤷‍♀️ , 📜    
이 아이콘들을 누르시면 코드, 개념 부가 설명을 보실 수 있습니다:)

---
----

# INTRO

고등학생과 미국 인구조사국 직원들이 손으로 쓴 70,000 개의 작은 숫자 이미지를 모은 MNIST 데이터셋을 사용할 것이다.      
각 이미지에는 어떤 숫자를 나타내는지 레이블링이 되어 있다.         

이 데이터셋은 학습용으로 아주 많이 시용되기 때문에 머신러닝 분야의 ‘Hello World’ 라고 불린다.       

![image](https://user-images.githubusercontent.com/76824611/138802301-5dc673f8-22d0-4d16-8f3e-d80fd20b769a.png)

먼저, 필요한 모듈들을 모두 불러오겠다
<details>
<summary>👀코드 보기</summary>
<div markdown="1">
  
```python
# 파이썬 ≥3.5 필수
import sys
assert sys.version_info >= (3, 5)

# 사이킷런 ≥0.20 필수
import sklearn
assert sklearn.__version__ >= "0.20"

# 공통 모듈 임포트
import numpy as np
import os

# 노트북 실행 결과를 동일하게 유지하기 위해
np.random.seed(42)

# 깔끔한 그래프 출력을 위해
%matplotlib inline
import matplotlib as mpl
import matplotlib.pyplot as plt
mpl.rc('axes', labelsize=14)
mpl.rc('xtick', labelsize=12)
mpl.rc('ytick', labelsize=12)

# 그림을 저장할 위치
PROJECT_ROOT_DIR = "."
CHAPTER_ID = "classification"
IMAGES_PATH = os.path.join(PROJECT_ROOT_DIR, "images", CHAPTER_ID)
os.makedirs(IMAGES_PATH, exist_ok=True)

def save_fig(fig_id, tight_layout=True, fig_extension="png", resolution=300):
    path = os.path.join(IMAGES_PATH, fig_id + "." + fig_extension)
    print("그림 저장:", fig_id)
    if tight_layout:
        plt.tight_layout()
    plt.savefig(path, format=fig_extension, dpi=resolution)
```
  
</div>
</details>


----


# 데이터 셋 불러오기   

그럼 먼저 데이터 셋을 불러와보자.      

  
```python
from sklearn.datasets import fetch_openml
mnist = fetch_openml('mnist_784', version=1, as_frame=False)
mnist.keys()
```
  
이 데이터 셋을 살펴보기 위해 ```mnist.keys()```를 사용하면,       
* **DESCR**: 데이터셋을 설명      
* **data**: 샘플이 하나의 행, 특성이 하나의 열로 구성된 배열    
* **target**: 레이블 배열(정답)   
  *  레이블은 문자열임 -> 대부분 머신러닝 알고리즘은 숫자를  기대하므로를 정수(```uint8```)로 변환 필요.      
  
```python
dict_keys(['data', 'target', 'frame', 'categories', 'feature_names', 'target_names', 'DESCR', 'details', 'url'])

# target 정수 변환
y = mnist["target"]
y = y.astype(np.uint8)
```  

<details>
<summary>📜 위 배열들 자세히 보기</summary>
<div markdown="1">
 
이미지가 70,000 개 존재    
* 각 이미지에는 784 개의 특성 존재   
  * 이미지가 28 X 28 픽셀이기 때문.       
  * 개개의 특성은 단순히 흰색 부터 255( 검은색)까지의 픽셀 강도를 나타냄     
![image](https://user-images.githubusercontent.com/76824611/138952849-416f3172-79ac-4ff9-aa99-83550c07106a.png)

```python
X, y = mnist["data"], mnist["target"]
X.shape
#(70000, 784)
y.shape
#(70000,)
```
  
</div>
</details>
  
<details>
<summary>📜 targe 자세히 보기</summary>
<div markdown="1">
 

```python
y = mnist["target"]
```
  
이때, y[0]은 아래와 같다
![image](https://user-images.githubusercontent.com/76824611/138953180-e9ee0a77-6e85-4477-aeae-bdbabe1beb98.png)
  
그러므로 이 이미지의 정답 레이블은 5여야 한다.  
  
```python
y[0]
# '5'
```
  
</div>
</details>  


## 훈련세트, 테스트 세트로 나누기
[더 알아보기](https://yerimoh.github.io/DL6/#%ED%8A%B8%EB%A0%88%EC%9D%B4%EB%8B%9D-%EB%B0%8F-%EA%B2%80%EC%A6%9D-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%A0%88%EC%9D%B4%EB%B8%94)
* **훈련 세트**: 이미 섞여 있어서 모든 교차 검증 폴드를 비슷하게 만듦.     
   * 하나의 폴드라도 특정 숫자가 누락되면 안 됨         

<details>
<summary>📜 데이터셋을 섞는 이유</summary>
<div markdown="1">

  
어떤 학습 알고리즘은 훈련 샘플의 순서에 민감해서 많은 비슷한 샘플이 연이어 나타나면 성능이 나빠짐 데이터셋을 섞으면 이런 문제를 방지가능   
➡️ SGD가 샘플을 섞어야 하는 대표적인 경우임.       
사이킷런의 SGDClassifier와 SGDRegressor는 기본적으로 에포크(전체 트레이닝 데이터세트에 대해 트레이닝해야 하는 횟수)마다 관련 데이터를 다시 섞음     
  
하지만 반대로 섞으면 오히려 나빠지는 경우가 있다          
(섞는게 좋지 않은 예)      
시계열 데이터
* 주식가격     
* 날씨 예보      

➡️ 이 경우는 다음 포스트에서 살펴보겠다      

  
</div>
</details> 
 

이 MNIST 데이터셋은 **이미** 나뉘어 있음.      
* 훈련 세트(앞쪽 60,000 개 이미지)       
* 테스트 세트 (뒤쪽 10,000 개 이미지)      

```python
X_train, X_test, y_train, y_test = X[:60000], X[60000:], y[:60000], y[60000:]
```
  


-----


# 이진 분류기 훈련
문제를 단순화해서 하나의 숫자, 예를 들면 숫자 만 식별해보겠습니다. 이 5-감지기 는 ‘5' 와 
'5 아님 ’ 두 개의 래스를 구분할 수 있는 이진 분류기 in aryclas fie 의 한 예입니다. 분류 작업을 
위해 타깃 벡터를 만들어보겠습니다. 



