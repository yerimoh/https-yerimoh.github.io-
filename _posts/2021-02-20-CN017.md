---
title: "[017] [INDEX] Computer Network: 서버-클라이언트 프로그래밍"
date:   2021-02-20
excerpt: ""
category: [CS basic]
layout: post
tag:
- CS basic
order: 0

comments: true
---


# 목차
일반적으로 서버-클라이언트 모델은 네트워크 서비스를 제공하는 서비스 제공자와 서비스 이용자 사이의 관계를 표현한다.      
서비스를 제공하는 프로그램을 서버 프로세스, 서버와 연결을 시도하여 서비스를 제공받는 프로그램을 클라이언트 프로세스라 한다. 이 절에서는 연결 형과 비연결형 서비스를 제공하는 서버와 클라이언트 프로그램을 각각 구현해본다.
1 연결형 서비스
소켓은 네트워크 통신을 위한 소프트웨어 교신점이 된다. 두 개의 독립 프로세스가 네트워크를 통해 통신하려면 논리적인 연관 관계를 맺어주는 소켓이 필요하다. 소켓을 이용한 전형적인 서버-클라이언트 프로그램을 작성하는 방법은 다음과 같다.
1.1 서버와 클라이언트의 동작
서버 프로세스는 다수의 클라이언트에 공개되는 Well-known 포트로 자신의 소켓 주소를 설정한 후에, 클라이언트의 연결 요청을 기다린다. 클라이언트 요구에 따라 연결이 설정되면 서버 프로세스가 제공하는 서비스가 시작된다. 이러한 서비스는 여러 클라이언트에 반복적으로 이루어지며, 동작 과정은 다음과 같다.
❶ 서비스 교신점(호스트의 IP 주소, 포트 번호) 공개
❷ 클라이언트로부터 발생하는 서비스 요구 대기
❸ 클라이언트에 서비스 제공
❹ 해당 클라이언트에 서비스 제공 완료
❺ 단계 ❷로 이동
그림 12-1 서버의 동작

클라이언트 프로세스는 서버의 Well-known 포트를 이용해 원하는 서버와 접속을 시도하고, 연결이 이루어지면 서버가 제공하는 서비스를 이용한다.
❶ 원하는 서비스를 제공하는 서버 확인
❷ 해당 서버와 연결 시도
❸ 서버에 서비스 요청
❹ 서비스 이용 완료
그림 12-2 클라이언트의 동작
서버
소켓 생성 (socket)
주소 정보를 소켓에 부여 (bind)
클라이언트 대기 큐 지정 (listen)
연결 요청 대기 (accept)
데이터 받음 (recv)
데이터 전송 (send)
클라이언트
소켓 생성 (socket)
서버에 연결 요청 (connect)
데이터 전송 (send)
데이터 받음 (recv)
소켓 닫음 (close)
그림 12-3 TCP를 이용한 통신 절차
1.2 프로그램 컴파일 방법
다음에 소개하는 예제는 현재의 시간 정보를 제공하는 서버 프로그램과 서버로부터 시간 정보 서비스를 받아 화면에 출력하는 클라이언트 프로그램이다. 클라이언트와 서버 프로그램을 따로 컴파일한 후 서버, 클라이언트 순으로 실행한다. 컴파일 명령의 -l 옵션은 소켓 함수를 지원하는 라이브러리를 지칭하는 것으로, 실행 파일에 해당 라이브러리 코드를 포함해준다.
컴파일이 성공하면 time_client와 time_server라는 두 개의 실행 파일이 현재 디렉토리에 생성된다.
2.1 클라이언트 프로그램
클라이언트 프로세스는 자신이 생성한 소켓의 주소를 지정하기 위해 client 변수에 IP 주소와 소켓 주소를 지정한다. 중간에 표기된 IP 주소 INADDR_ANY는 자기 자신을 의미하고, 소켓 주소 0은 시스템에서 임의의 포트를 할당하라는 의미이다.
서버와 통신하려면 sendto( ) 함수에 필요한 서버 주소를 표시하는데, server 변수를 이런 목적으로 사용한다.
bind( ) 함수를 성공적으로 실행하면 클라이언트가 먼저 서버에 문자 데이터를 전송한다.
sendto( ) 함수는 다섯 번째 매개변수 server에 서버의 주소를 표시하여 데이터가 서버 프로 세스에 올바로 전송될 수 있도록 한다. 마지막으로 recvfrom( ) 함수를 이용해 서버가 전송한 시간 정보를 전송받아 출력한다. recvfrom( )의 다섯 번째와 여섯 번째 매개변수를 0으로 지정하면 시간 정보를 송신하는 서버의 주소 값을 받아들이지 않겠다는 의미이다.

쉽게 배우는 데이터 통신과 컴퓨터 네트워크 (개정판) | 박기현

[YES24 eBook]

http://www.yes24.com/24/goods/97828131
